<div class="dashboard-container">
  <!-- Header -->
  <header class="dashboard-header">
    <div class="header-content">
      <div class="welcome-section">
      <h2>{{ greetingMessage }}, {{ userData.name || 'Utilisateur' }}</h2>

        <p>Voici un aperçu de vos activités récentes</p>
      </div>
      <div class="quick-actions">
        <button class="action-btn primary" (click)="openBookingModal()">
          <i class="fas fa-plus"></i>
          <span>Nouveau RDV</span>
        </button>
        <button class="action-btn secondary" (click)="navigateToCalendar()">
          <i class="fas fa-calendar-alt"></i>
          <span>Calendrier</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Stats Cards -->
  <section class="stats-section">
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-icon total">
          <i class="fas fa-calendar-check"></i>
        </div>
        <div class="stat-content">
          <h3>{{ dashboardStats.totalAppointments }}</h3>
          <p>RDV Total</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon upcoming">
          <i class="fas fa-clock"></i>
        </div>
        <div class="stat-content">
          <h3>{{ dashboardStats.upcomingAppointments }}</h3>
          <p>Prochains RDV</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon completed">
          <i class="fas fa-check-circle"></i>
        </div>
        <div class="stat-content">
          <h3>{{ dashboardStats.completedAppointments }}</h3>
          <p>Terminés</p>
        </div>
      </div>

      <div class="stat-card">
        <div class="stat-icon experts">
          <i class="fas fa-users"></i>
        </div>
        <div class="stat-content">
          <h3>{{ dashboardStats.uniqueExperts }}</h3>
          <p>Experts consultés</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Main Content -->
  <div class="main-content">
    <!-- Left Column -->
    <div class="left-column">
      <!-- Upcoming Appointments -->
      <div class="content-card">
        <div class="card-header">
          <h2><i class="fas fa-calendar-day"></i> Prochains Rendez-vous</h2>
          <button class="view-all-btn" (click)="navigateToCalendar()">
            Voir tout <i class="fas fa-arrow-right"></i>
          </button>
        </div>
        <div class="card-content">
          <div *ngIf="upcomingApp.length === 0" class="empty-state">
            <i class="fas fa-calendar-times"></i>
            <h3>Aucun RDV à venir</h3>
            <p>Planifiez votre prochain rendez-vous</p>
            <button class="cta-btn" (click)="openBookingModal()">
              Réserver maintenant
            </button>
          </div>
          
          <div *ngIf="upcomingApp.length > 0" class="appointments-list">
            <div 
              *ngFor="let appointment of upcomingApp; trackBy: trackAppointment"
              class="appointment-item"
              [class.today]="isToday(appointment.service?.date)"
              [class.tomorrow]="isTomorrow(appointment.service?.date)"
            >
              <div class="appointment-date">
                <span class="day">{{ formatDay(appointment.service?.date) }}</span>
                <span class="month">{{ formatMonth(appointment.service?.date) }}</span>
              </div>
              <div class="appointment-details">
                <h4>{{ appointment.service?.name }}</h4>
                <p class="expert">
                  <i class="fas fa-user-md"></i>
                  {{ appointment.expert?.name }}
                </p>
                <p class="time">
                  <i class="fas fa-clock"></i>
                  {{ appointment.service?.start_time }} - {{ appointment.service?.end_time }}
                </p>
                <span class="platform-badge" [class]="getPlatformClass(appointment.service?.preferred_platform)">
                  {{ appointment.service?.preferred_platform }}
                </span>

              </div>
              <div class="appointment-actions">
                <button class="action-icon" (click)="rescheduleAppointment(appointment)" title="Reprogrammer">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="action-icon cancel" (click)="cancelAppointment(appointment)" title="Annuler">
                  <i class="fas fa-times"></i>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Recent Activity -->
      <div class="content-card">
        <div class="card-header">
          <h2><i class="fas fa-history"></i> Activité Récente</h2>
        </div>
        <div class="card-content">
          <div class="activity-timeline">
            <div 
              *ngFor="let activity of recentActivity; trackBy: trackActivity" 
              class="timeline-item"
              [class]="activity.type"
            >
              <div class="timeline-icon">
                <i [class]="getActivityIcon(activity.type)"></i>
              </div>
              <div class="timeline-content">
                <h4>{{ activity.title }}</h4>
                <p>{{ activity.description }}</p>
                <span class="timeline-date">{{ formatRelativeDate(activity.date) }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Column -->
    <div class="right-column">

      <!-- Favorite Experts -->
      <div class="content-card">
        <div class="card-header">
          <h2><i class="fas fa-star"></i> Experts Favoris</h2>
        </div>
        <div class="card-content">
          <div class="experts-list">
            <div 
              *ngFor="let expert of favoriteExperts; trackBy: trackExpert" 
              class="expert-item"
            >
              <div class="expert-avatar">
                <img [src]="expert.avatar || '/assets/default-avatar.png'" [alt]="expert.name">
                <div class="expert-status" [class.online]="expert.isOnline"></div>
              </div>
              <div class="expert-info">
                <h4>{{ expert.name }}</h4>
                <p>{{ expert.specialty }}</p>
                <div class="expert-rating">
                  <i *ngFor="let star of getStars(expert.rating)" class="fas fa-star"></i>
                  <span>({{ expert.reviewCount }})</span>
                </div>
              </div>
              <button class="book-btn" (click)="bookWithExpert(expert)">
                Réserver
              </button>
            </div>
          </div>
        </div>
      </div>


    </div>
  </div>
</div>